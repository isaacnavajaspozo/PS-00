## Al crear el contendor desde Proxmox tengo que agregarlo como DHCP
## Nodo > Contenedor > Options > Start at boot : yes        # para encender el contenedor al encender la m√°quina

# actualizo
apt updeate && apt upgrade -y

## desde la consola del contenedor a trav√©s de proxmox
# Amplio tiempo de ssh y deshabilitar la suspensi√≥n
systemctl mask sleep.target suspend.target hibernate.target hybrid-sleep.target

# Realizo unos cambios en el archivo de configuraci√≥n
nano /etc/ssh/sshd_config
----------------------------------------------------------------------------
    Port 22
    PasswordAuthentication yes
    PermitRootLogin yes
----------------------------------------------------------------------------

# Inicializo el servicio y lo habilito para inicio de la sesi√≥n
systemctl start sshd
systemctl status sshd
systemctl enable sshd

========================================================================================================
[ü™ñüì© INSTALAR ANTIVIRUS]::
# paquetes de Linux de utilizaci√≥n r√°pida y pr√°ctica (escaneres):
# üíØ realizo la instalaci√≥n de un antivirus para automatizar el escaner de archivos corruptos en el servidor

## üëπ ClamAV
# instalaci√≥n antivirus Linux:
apt install clamav
apt install clamav-freshclam
# busco actualizaciones en la base de datos
sudo freshclam
# escaneo manualmente el sistema
# clamscan -[par√°metros] [ruta de carpeta]
# sudo clamscan -r /
# sudo clamscan -r /home
# formas de uso con clamav:
# guardo un registro de archivos infectados
# sudo clamscan -l /ruta/al/archivo.txt -r /ruta/al/directorio

# mandar archivo a cuarentena (para no causar da√±o al servidor):
# sudo clamscan --move=/path/to/quarantine -r /ruta/al/directorio
# sudo clamscan --move=/path/to/quarantine -r /ruta/al/directorio -l /ruta/al/archivo.txt

# borrar archivos maliciosos:
# sudo clamscan --remove -r /ruta/al/directorio
# sudo clamscan --remove -r /ruta/al/directorio -l /ruta/al/archivo.txt

# actualizar base de datos 
sudo freshclam

## üî¢ anacron
# anacron es ideal para sistemas que no est√°n siempre encendidos (como un pc personal). Ejecuta tareas peri√≥dicas aunque el equipo est√© apagado en el momento programado.
# lo que puedo hacer es un anacron y para automatizar el antivirus
sudo apt install anacron -y

# para ejecutar los comandos necesito privilegios root
su
  > ***********

vim /etc/anacrontab
---------------------------------------------------------------------
# /etc/anacrontab
# formato: periodo | delay | identificador | comando
# .---------------------- per√≠odo en d√≠as (1 = diario, 7 = semanal, etc.)
# | .-------------------- retraso en minutos despu√©s del arranque
# | |      .------------- Identificador de trabajo (utilizado para registros y seguimiento de estado) (restic.weekly, restic.daily)
# | |      |        .---- comando a ejecutar
# | |      |        |
7 10 clamav.weekly nice /usr/bin/freshclam && nice /usr/bin/clamscan --remove -r / -l /var/clamav/deletefiles.txt
365 10 backup.deletefiles nice tar -czf /var/clamav/deletefiles_$(date +\%Y-\%m-\%d).tar.gz -C /var/clamav deletefiles.txt && > /var/clamav/deletefiles.txt
---------------------------------------------------------------------
# con freshclam, actualizo la base de datos del antivirus.
# con clamscan --remove -r /home -l /home/isaac/ClamAV/deletefiles.txt, elimino autom√°ticamente los archivos infectados de la ruta principal y guarda en mi home un txt con los archivos infectados eliminados.
# con 365 10 backup.deletefiles nice tar -czf /var/clamav/deletefiles_$(date +\%Y-\%m-\%d).tar.gz -C /var/clamav deletefiles.txt && > /var/clamav/deletefiles.txt, una vez al a√±o cojo el archivo deletefiles.txt, lo comprimo en con la fecha actual y creo un nuevo archivo vac√≠o deletefiles.txt.

